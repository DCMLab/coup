Traceback (most recent call last):
  File "C:\Users\hentsche\.conda\envs\coup\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\hentsche\.conda\envs\coup\lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\hentsche\.conda\envs\coup\lib\site-packages\jupyter_core\utils\__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "C:\Users\hentsche\.conda\envs\coup\lib\asyncio\base_events.py", line 649, in run_until_complete
    return future.result()
  File "C:\Users\hentsche\.conda\envs\coup\lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\hentsche\.conda\envs\coup\lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\hentsche\.conda\envs\coup\lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
show(ascending, ('i64', 'Ger'))
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mTypeError[0m                                 Traceback (most recent call last)
File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\groupby.py:1353[0m, in [0;36mGroupBy.apply[1;34m(self, func, *args, **kwargs)[0m
[0;32m   1352[0m [38;5;28;01mtry[39;00m:
[1;32m-> 1353[0m     result [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_python_apply_general[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_selected_obj[49m[43m)[49m
[0;32m   1354[0m [38;5;28;01mexcept[39;00m [38;5;167;01mTypeError[39;00m:
[0;32m   1355[0m     [38;5;66;03m# gh-20949[39;00m
[0;32m   1356[0m     [38;5;66;03m# try again, with .apply acting as a filtering[39;00m
[1;32m   (...)[0m
[0;32m   1360[0m     [38;5;66;03m# fails on *some* columns, e.g. a numeric operation[39;00m
[0;32m   1361[0m     [38;5;66;03m# on a string grouper column[39;00m

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\groupby.py:1402[0m, in [0;36mGroupBy._python_apply_general[1;34m(self, f, data, not_indexed_same, is_transform, is_agg)[0m
[0;32m   1376[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[0;32m   1377[0m [38;5;124;03mApply function f in python space[39;00m
[0;32m   1378[0m 
[1;32m   (...)[0m
[0;32m   1400[0m [38;5;124;03m    data after applying f[39;00m
[0;32m   1401[0m [38;5;124;03m"""[39;00m
[1;32m-> 1402[0m values, mutated [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgrouper[49m[38;5;241;43m.[39;49m[43mapply[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[43mdata[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43maxis[49m[43m)[49m
[0;32m   1403[0m [38;5;28;01mif[39;00m not_indexed_same [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\ops.py:767[0m, in [0;36mBaseGrouper.apply[1;34m(self, f, data, axis)[0m
[0;32m    766[0m group_axes [38;5;241m=[39m group[38;5;241m.[39maxes
[1;32m--> 767[0m res [38;5;241m=[39m [43mf[49m[43m([49m[43mgroup[49m[43m)[49m
[0;32m    768[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m mutated [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m _is_indexed_like(res, group_axes, axis):

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\groupby.py:1341[0m, in [0;36mGroupBy.apply.<locals>.f[1;34m(g)[0m
[0;32m   1340[0m [38;5;28;01mwith[39;00m np[38;5;241m.[39merrstate([38;5;28mall[39m[38;5;241m=[39m[38;5;124m"[39m[38;5;124mignore[39m[38;5;124m"[39m):
[1;32m-> 1341[0m     [38;5;28;01mreturn[39;00m func(g, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)

Cell [1;32mIn[15], line 6[0m, in [0;36mfiltr[1;34m(df, query, column)[0m
[0;32m      5[0m     lengths [38;5;241m=[39m [[38;5;28mlen[39m(q) [38;5;28;01mfor[39;00m q [38;5;129;01min[39;00m query]
[1;32m----> 6[0m     n_grams [38;5;241m=[39m [[38;5;28mtuple[39m(e[:l] [38;5;28;01mfor[39;00m e,l  [38;5;129;01min[39;00m [38;5;28mzip[39m(t, lengths)) [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m n_grams]
[0;32m      7[0m [38;5;28;01mreturn[39;00m query [38;5;129;01min[39;00m n_grams

Cell [1;32mIn[15], line 6[0m, in [0;36m<listcomp>[1;34m(.0)[0m
[0;32m      5[0m     lengths [38;5;241m=[39m [[38;5;28mlen[39m(q) [38;5;28;01mfor[39;00m q [38;5;129;01min[39;00m query]
[1;32m----> 6[0m     n_grams [38;5;241m=[39m [[38;5;28;43mtuple[39;49m[43m([49m[43me[49m[43m[[49m[43m:[49m[43ml[49m[43m][49m[43m [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43me[49m[43m,[49m[43ml[49m[43m  [49m[38;5;129;43;01min[39;49;00m[43m [49m[38;5;28;43mzip[39;49m[43m([49m[43mt[49m[43m,[49m[43m [49m[43mlengths[49m[43m)[49m[43m)[49m [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m n_grams]
[0;32m      7[0m [38;5;28;01mreturn[39;00m query [38;5;129;01min[39;00m n_grams

Cell [1;32mIn[15], line 6[0m, in [0;36m<genexpr>[1;34m(.0)[0m
[0;32m      5[0m     lengths [38;5;241m=[39m [[38;5;28mlen[39m(q) [38;5;28;01mfor[39;00m q [38;5;129;01min[39;00m query]
[1;32m----> 6[0m     n_grams [38;5;241m=[39m [[38;5;28mtuple[39m([43me[49m[43m[[49m[43m:[49m[43ml[49m[43m][49m [38;5;28;01mfor[39;00m e,l  [38;5;129;01min[39;00m [38;5;28mzip[39m(t, lengths)) [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m n_grams]
[0;32m      7[0m [38;5;28;01mreturn[39;00m query [38;5;129;01min[39;00m n_grams

[1;31mTypeError[0m: 'float' object is not subscriptable

During handling of the above exception, another exception occurred:

[1;31mTypeError[0m                                 Traceback (most recent call last)
Cell [1;32mIn[22], line 1[0m
[1;32m----> 1[0m [43mshow[49m[43m([49m[43mascending[49m[43m,[49m[43m [49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mi64[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mGer[39;49m[38;5;124;43m'[39;49m[43m)[49m[43m)[49m

Cell [1;32mIn[15], line 10[0m, in [0;36mshow[1;34m(df, query, column)[0m
[0;32m      9[0m [38;5;28;01mdef[39;00m [38;5;21mshow[39m(df, query, column[38;5;241m=[39m[38;5;124m'[39m[38;5;124mchord[39m[38;5;124m'[39m):
[1;32m---> 10[0m     selector [38;5;241m=[39m [43mdf[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m[43mlevel[49m[38;5;241;43m=[39;49m[38;5;241;43m0[39;49m[43m)[49m[38;5;241;43m.[39;49m[43mapply[49m[43m([49m[43mfiltr[49m[43m,[49m[43m [49m[43mquery[49m[43m,[49m[43m [49m[43mcolumn[49m[43m)[49m
[0;32m     11[0m     [38;5;28;01mreturn[39;00m df[selector[df[38;5;241m.[39mindex[38;5;241m.[39mget_level_values([38;5;241m0[39m)][38;5;241m.[39mvalues]

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\groupby.py:1363[0m, in [0;36mGroupBy.apply[1;34m(self, func, *args, **kwargs)[0m
[0;32m   1353[0m         result [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_python_apply_general(f, [38;5;28mself[39m[38;5;241m.[39m_selected_obj)
[0;32m   1354[0m     [38;5;28;01mexcept[39;00m [38;5;167;01mTypeError[39;00m:
[0;32m   1355[0m         [38;5;66;03m# gh-20949[39;00m
[0;32m   1356[0m         [38;5;66;03m# try again, with .apply acting as a filtering[39;00m
[1;32m   (...)[0m
[0;32m   1360[0m         [38;5;66;03m# fails on *some* columns, e.g. a numeric operation[39;00m
[0;32m   1361[0m         [38;5;66;03m# on a string grouper column[39;00m
[1;32m-> 1363[0m         [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_python_apply_general[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_obj_with_exclusions[49m[43m)[49m
[0;32m   1365[0m [38;5;28;01mreturn[39;00m result

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\groupby.py:1402[0m, in [0;36mGroupBy._python_apply_general[1;34m(self, f, data, not_indexed_same, is_transform, is_agg)[0m
[0;32m   1367[0m [38;5;129m@final[39m
[0;32m   1368[0m [38;5;28;01mdef[39;00m [38;5;21m_python_apply_general[39m(
[0;32m   1369[0m     [38;5;28mself[39m,
[1;32m   (...)[0m
[0;32m   1374[0m     is_agg: [38;5;28mbool[39m [38;5;241m=[39m [38;5;28;01mFalse[39;00m,
[0;32m   1375[0m ) [38;5;241m-[39m[38;5;241m>[39m NDFrameT:
[0;32m   1376[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[0;32m   1377[0m [38;5;124;03m    Apply function f in python space[39;00m
[0;32m   1378[0m 
[1;32m   (...)[0m
[0;32m   1400[0m [38;5;124;03m        data after applying f[39;00m
[0;32m   1401[0m [38;5;124;03m    """[39;00m
[1;32m-> 1402[0m     values, mutated [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgrouper[49m[38;5;241;43m.[39;49m[43mapply[49m[43m([49m[43mf[49m[43m,[49m[43m [49m[43mdata[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43maxis[49m[43m)[49m
[0;32m   1403[0m     [38;5;28;01mif[39;00m not_indexed_same [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m   1404[0m         not_indexed_same [38;5;241m=[39m mutated

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\ops.py:767[0m, in [0;36mBaseGrouper.apply[1;34m(self, f, data, axis)[0m
[0;32m    765[0m [38;5;66;03m# group might be modified[39;00m
[0;32m    766[0m group_axes [38;5;241m=[39m group[38;5;241m.[39maxes
[1;32m--> 767[0m res [38;5;241m=[39m [43mf[49m[43m([49m[43mgroup[49m[43m)[49m
[0;32m    768[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m mutated [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m _is_indexed_like(res, group_axes, axis):
[0;32m    769[0m     mutated [38;5;241m=[39m [38;5;28;01mTrue[39;00m

File [1;32m~\.conda\envs\coup\lib\site-packages\pandas\core\groupby\groupby.py:1341[0m, in [0;36mGroupBy.apply.<locals>.f[1;34m(g)[0m
[0;32m   1338[0m [38;5;129m@wraps[39m(func)
[0;32m   1339[0m [38;5;28;01mdef[39;00m [38;5;21mf[39m(g):
[0;32m   1340[0m     [38;5;28;01mwith[39;00m np[38;5;241m.[39merrstate([38;5;28mall[39m[38;5;241m=[39m[38;5;124m"[39m[38;5;124mignore[39m[38;5;124m"[39m):
[1;32m-> 1341[0m         [38;5;28;01mreturn[39;00m func(g, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)

Cell [1;32mIn[15], line 6[0m, in [0;36mfiltr[1;34m(df, query, column)[0m
[0;32m      4[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(query[[38;5;241m0[39m], [38;5;28mstr[39m):
[0;32m      5[0m     lengths [38;5;241m=[39m [[38;5;28mlen[39m(q) [38;5;28;01mfor[39;00m q [38;5;129;01min[39;00m query]
[1;32m----> 6[0m     n_grams [38;5;241m=[39m [[38;5;28mtuple[39m(e[:l] [38;5;28;01mfor[39;00m e,l  [38;5;129;01min[39;00m [38;5;28mzip[39m(t, lengths)) [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m n_grams]
[0;32m      7[0m [38;5;28;01mreturn[39;00m query [38;5;129;01min[39;00m n_grams

Cell [1;32mIn[15], line 6[0m, in [0;36m<listcomp>[1;34m(.0)[0m
[0;32m      4[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(query[[38;5;241m0[39m], [38;5;28mstr[39m):
[0;32m      5[0m     lengths [38;5;241m=[39m [[38;5;28mlen[39m(q) [38;5;28;01mfor[39;00m q [38;5;129;01min[39;00m query]
[1;32m----> 6[0m     n_grams [38;5;241m=[39m [[38;5;28;43mtuple[39;49m[43m([49m[43me[49m[43m[[49m[43m:[49m[43ml[49m[43m][49m[43m [49m[38;5;28;43;01mfor[39;49;00m[43m [49m[43me[49m[43m,[49m[43ml[49m[43m  [49m[38;5;129;43;01min[39;49;00m[43m [49m[38;5;28;43mzip[39;49m[43m([49m[43mt[49m[43m,[49m[43m [49m[43mlengths[49m[43m)[49m[43m)[49m [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m n_grams]
[0;32m      7[0m [38;5;28;01mreturn[39;00m query [38;5;129;01min[39;00m n_grams

Cell [1;32mIn[15], line 6[0m, in [0;36m<genexpr>[1;34m(.0)[0m
[0;32m      4[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(query[[38;5;241m0[39m], [38;5;28mstr[39m):
[0;32m      5[0m     lengths [38;5;241m=[39m [[38;5;28mlen[39m(q) [38;5;28;01mfor[39;00m q [38;5;129;01min[39;00m query]
[1;32m----> 6[0m     n_grams [38;5;241m=[39m [[38;5;28mtuple[39m([43me[49m[43m[[49m[43m:[49m[43ml[49m[43m][49m [38;5;28;01mfor[39;00m e,l  [38;5;129;01min[39;00m [38;5;28mzip[39m(t, lengths)) [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m n_grams]
[0;32m      7[0m [38;5;28;01mreturn[39;00m query [38;5;129;01min[39;00m n_grams

[1;31mTypeError[0m: 'float' object is not subscriptable

